<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>QQ空间登录 - Retro Mac Edition</title>
    <style>
        /* --- 现代网页基础布局 --- */
        :root {
            --mac-beige: #e4e0cf;
            --mac-shadow: #b8b4a5;
            --screen-bg: #1a1a1a;
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background: var(--bg-gradient);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        /* --- CSS 绘制的复古 Mac 电脑 --- */
        .mac-classic {
            position: relative;
            width: 320px;
            height: 440px;
            background-color: var(--mac-beige);
            border-radius: 20px;
            box-shadow:
                    inset 4px 4px 10px rgba(255,255,255,0.5),
                    inset -4px -4px 10px rgba(0,0,0,0.1),
                    20px 40px 80px rgba(0,0,0,0.25); /* 现代风格的长投影 */
            padding: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-sizing: border-box;
            /* 稍微前倾的 3D 感 */
            transform: perspective(1000px) rotateX(2deg);
            transition: transform 0.3s ease;
        }

        .mac-classic:hover {
            transform: perspective(1000px) rotateX(0deg) translateY(-5px);
        }

        /* 屏幕外边框 */
        .monitor-bezel {
            width: 100%;
            height: 240px;
            background: #dcdcce;
            border-radius: 16px;
            border: 2px solid #d1d1c2;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 25px;
            position: relative;
        }

        /* CRT 屏幕本体 */
        .crt-screen {
            width: 90%;
            height: 90%;
            background: var(--screen-bg);
            border-radius: 12px 12px 20px 20px; /* CRT 屏幕特有的弧度 */
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #fff;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
        }

        /* CRT 扫描线特效 */
        .crt-screen::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                    0deg,
                    rgba(0, 0, 0, 0.1) 0px,
                    rgba(0, 0, 0, 0.1) 1px,
                    transparent 1px,
                    transparent 2px
            );
            pointer-events: none;
            z-index: 10;
        }

        /* 软盘驱动器插槽 */
        .floppy-slot {
            width: 140px;
            height: 12px;
            background: #4a4a4a;
            border-radius: 6px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 20px;
            position: relative;
        }
        /* 软盘槽的细节 */
        .floppy-slot::after {
            content: "";
            position: absolute;
            right: 10px;
            top: 4px;
            width: 20px;
            height: 4px;
            background: #222;
            border-radius: 2px;
        }

        /* 彩虹 Logo */
        .rainbow-logo {
            width: 24px;
            height: 24px;
            position: absolute;
            bottom: 30px;
            left: 30px;
            background: linear-gradient(180deg,
            #60bb46 16%,
            #fdb827 16%, #fdb827 33%,
            #f5821f 33%, #f5821f 50%,
            #e03a3e 50%, #e03a3e 66%,
            #963d97 66%, #963d97 83%,
            #009ddc 83%);
            clip-path: polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%);
        }

        /* 通风口 */
        .vents {
            position: absolute;
            bottom: 30px;
            right: 30px;
            display: flex;
            gap: 4px;
        }
        .vent-line {
            width: 4px;
            height: 24px;
            background: #b8b4a5;
            border-radius: 2px;
            box-shadow: inset 1px 1px 2px rgba(0,0,0,0.2);
        }

        /* --- 内容区域样式 --- */
        .content-wrapper {
            z-index: 5;
            text-align: center;
            width: 100%;
            height: 100%;
            display: flex; /* 默认 flex */
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* 隐藏状态 */
        .hidden {
            display: none !important;
        }

        h1 {
            font-size: 16px;
            margin: 0 0 10px 0;
            font-weight: 500;
            letter-spacing: 1px;
            opacity: 0.9;
        }

        img {
            width: 140px;
            height: 140px;
            border-radius: 4px;
            border: 4px solid #fff; /* 像是屏幕里的一个白框 */
        }

        p {
            font-size: 12px;
            color: #aaa;
            margin: 10px 0 0 0;
        }

        .success-icon {
            font-size: 40px;
            color: #4ade80; /* 现代荧光绿 */
            margin-bottom: 10px;
        }

        .blink {
            animation: blinker 1.5s linear infinite;
        }

        @keyframes blinker {
            50% { opacity: 0; }
        }
    </style>
</head>
<body>

<div class="mac-classic">

    <div class="monitor-bezel">
        <div class="crt-screen">

            <div id="qr-container" class="content-wrapper">
                <h1>QZONE LOGIN</h1>
                <img src="data:image/png;base64,{{.QRCodeBase64}}" alt="QR Code">
                <p class="blink">> 等待手机扫描...</p>
            </div>

            <div id="success-container" class="content-wrapper hidden">
                <div class="success-icon">✓</div>
                <h1>WELCOME BACK</h1>
                <p style="color: #4ade80;">> Access Granted</p>
            </div>

        </div>
    </div>

    <div class="floppy-slot"></div>

    <div class="rainbow-logo"></div>
    <div class="vents">
        <div class="vent-line"></div>
        <div class="vent-line"></div>
        <div class="vent-line"></div>
        <div class="vent-line"></div>
        <div class="vent-line"></div>
    </div>

</div>

<div style="margin-top: 30px; color: #666; font-size: 12px; font-weight: 500;">
    SECURE LOGIN VIA TENCENT QQ
</div>

<script>
    // 保持原有的业务逻辑
    setInterval(function() {
        fetch('/status')
            .then(r => r.json())
            .then(data => {
                if (data.success) {
                    // 切换 class 来控制显示/隐藏
                    const qrContainer = document.getElementById('qr-container');
                    const successContainer = document.getElementById('success-container');

                    if (qrContainer && successContainer) {
                        qrContainer.classList.add('hidden');
                        successContainer.classList.remove('hidden');
                    }

                    setTimeout(function() { window.close(); }, 1500);
                }
            })
            .catch(() => {});
    }, 1000);
</script>
</body>
</html>